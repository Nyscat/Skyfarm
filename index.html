<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SkyFarm — Home</title>

  <!-- Firebase (compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-auth-compat.js"></script>

  <style>
    :root { --brand:#0B7A6E; --ink:#0f172a; --muted:#64748b; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; background:#f6fbf8; color:var(--ink); }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 20px; }

    /* Header */
    .topbar { display:flex; align-items:center; gap:16px; padding:14px 20px; background:#fff; border-bottom:1px solid #e5e7eb; position:sticky; top:0; z-index:10; }
    .logo { display:flex; align-items:center; gap:10px; font-weight:700; color:var(--brand); }
    .logo svg { width:28px; height:28px; }
    .spacer { flex:1; }
    .topnav a { color:var(--brand); text-decoration:none; margin:0 8px; font-weight:600; }
    .btn { border:1px solid #cbd5e1; background:#fff; padding:8px 12px; border-radius:10px; cursor:pointer; }
    .btn.primary { background:var(--brand); color:#fff; border-color: var(--brand); }
    .muted { color:var(--muted); }

    /* Hero */
    .hero { display:grid; grid-template-columns: 1.2fr 1fr; gap:24px; align-items:center; padding:24px 0; }
    .hero h1 { margin:0 0 8px; font-size:2rem; }
    .hero p  { margin:0; color:#475569; }
    .card { background:#fff; border:1px solid #e5e7eb; border-radius:16px; padding:16px; }
    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(230px,1fr)); gap:12px; }

    .appcard { display:flex; flex-direction:column; gap:8px; padding:16px; border-radius:14px; border:1px solid #e2e8f0; background:#fff; transition: transform .05s ease, box-shadow .2s ease; }
    .appcard:hover { transform: translateY(-1px); box-shadow: 0 6px 20px rgba(0,0,0,.06); }
    .appcard h3 { margin:0; font-size:1.1rem; }
    .appcard p { margin:0; color:#475569; font-size:.95rem; }
    .go { margin-top:8px; align-self:flex-start; }

    footer { text-align:center; color:#94a3b8; padding:24px 0; font-size:.9rem; }
    @media (max-width: 860px){ .hero{ grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="logo">
      <!-- Simple leaf mark -->
      <svg viewBox="0 0 24 24" fill="none"><path d="M5 13c8-9 14-8 14-8s1 6-7 14c-4 4-9 3-9 3s-1-5 3-9Z" stroke="currentColor" stroke-width="1.8"/></svg>
      <span>SkyFarm</span>
    </div>
    <nav class="topnav">
      <a href="#" data-nav="diary">Diary</a>
      <a href="#" data-nav="map">Map</a>
      <a href="#" data-nav="chem">Chemicals</a>
      <a href="#" data-nav="admin">Users</a>
    </nav>
    <div class="spacer"></div>
    <span id="authState" class="muted">Connecting…</span>
    <button id="signOutBtn" class="btn" style="display:none">Sign out</button>
  </div>

  <div class="wrap">
    <section class="hero">
      <div>
        <h1>Welcome to SkyFarm</h1>
        <p>Field diary, paddock map, chemical inventory, livestock and rainfall — all in one place.</p>
        <div style="margin-top:14px; display:flex; gap:8px;">
          <button class="btn primary" data-nav="diary">Open Diary</button>
          <button class="btn" data-nav="map">Open Map</button>
        </div>
      </div>
      <div class="card">
        <strong>Quick links</strong>
        <div class="grid" style="margin-top:10px">
          <a class="appcard" href="#" data-nav="diary">
            <h3>Diary</h3>
            <p>Activities, rainfall, mustering, trucking & chemical usage.</p>
            <button class="btn go">Open</button>
          </a>
          <a class="appcard" href="#" data-nav="map">
            <h3>Map</h3>
            <p>Paddocks, stock per paddock, simple visual overview.</p>
            <button class="btn go">Open</button>
          </a>
          <a class="appcard" href="#" data-nav="chem">
            <h3>Chemical Inventory</h3>
            <p>Per-property inventory, SDS links, CSV export.</p>
            <button class="btn go">Open</button>
          </a>
          <a class="appcard" href="#" data-nav="admin">
            <h3>Users & Roles</h3>
            <p>Invite users via email link, assign properties.</p>
            <button class="btn go">Open</button>
          </a>
        </div>
      </div>
    </section>

    <footer>© <span id="yr"></span> Consentes Pastoral · SkyFarm</footer>
  </div>

  <script>
    /** Firebase **/
    const firebaseConfig = {
      apiKey: "AIzaSyBO9_0v1HdvVDuK3EFvaBGvQJIGvBwmW70",
      authDomain: "consentes-pastoral.firebaseapp.com",
      projectId: "consentes-pastoral",
      appId: "1:494858780013:web:d87497b370c82eeab06e64"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    /** Routing helper: works on localhost and on consentes.com.au */
    function pageUrl(slug){
      // keep filenames the same as your repo files
      const base = location.origin;
      if (slug === 'diary') return `${base}/skyfarm-diary.html`;
      if (slug === 'map')   return `${base}/skyfarm-map.html`;
      if (slug === 'chem')  return `${base}/skyfarm-chemical-inventory.html`;
      if (slug === 'admin') return `${base}/skyfarm-admin-users.html`;
      return base + '/';
    }

    // Make all [data-nav] links/buttons work
    document.querySelectorAll('[data-nav]').forEach(el=>{
      el.addEventListener('click', (e)=>{
        e.preventDefault();
        const to = pageUrl(el.getAttribute('data-nav'));
        location.href = to;
      });
    });

    // Auth state: anonymous is fine (your pages already use it)
    const authState = document.getElementById('authState');
    const signOutBtn = document.getElementById('signOutBtn');
    auth.onAuthStateChanged(user=>{
      if (user){
        authState.textContent = user.isAnonymous ? 'Connected (guest)' : `Signed in: ${user.email || 'User'}`;
        signOutBtn.style.display = user.isAnonymous ? 'none' : 'inline-block';
      } else {
        authState.textContent = 'Connecting…';
        signOutBtn.style.display = 'none';
      }
    });

    // Try anon auth (non-blocking)
    auth.signInAnonymously().catch(()=>{ /* ok */ });

    // Sign out (only for email-link users)
    signOutBtn.onclick = ()=> auth.signOut();

    // Footer year
    document.getElementById('yr').textContent = new Date().getFullYear();
  </script>
</body>
</html>